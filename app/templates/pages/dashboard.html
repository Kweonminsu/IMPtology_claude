{% extends "base.html" %}

{% block title %}IMPtology - 대시보드{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', path='css/dashboard.css') }}">
{% endblock %}

{% block page_title %}대시보드{% endblock %}

{% block content %}
<div class="dashboard">
    <div class="dashboard-header">
        <div class="time-period-selector">
            <button class="time-button active">오늘</button>
            <button class="time-button">이번 주</button>
            <button class="time-button">이번 달</button>
            <button class="time-button">분기</button>
            <button class="time-button">연간</button>
            <button class="time-button custom">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
                    <line x1="16" y1="2" x2="16" y2="6"></line>
                    <line x1="8" y1="2" x2="8" y2="6"></line>
                    <line x1="3" y1="10" x2="21" y2="10"></line>
                </svg>
                커스텀
            </button>
        </div>
        
        <div class="refresh-control">
            <span class="last-updated">최종 업데이트: 5분 전</span>
            <button class="refresh-button">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M23 4v6h-6"></path>
                    <path d="M1 20v-6h6"></path>
                    <path d="M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"></path>
                </svg>
                새로고침
            </button>
        </div>
    </div>
    
    <div class="metrics-overview">
        <div class="metric-card">
            <div class="metric-icon data-sources">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                    <polyline points="3.29 7 12 12 20.71 7"></polyline>
                    <line x1="12" y1="22" x2="12" y2="12"></line>
                </svg>
            </div>
            <div class="metric-content">
                <div class="metric-title">데이터 소스</div>
                <div class="metric-value">42</div>
                <div class="metric-change positive">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="18 15 12 9 6 15"></polyline>
                    </svg>
                    <span>+8%</span>
                </div>
            </div>
        </div>
        
        <div class="metric-card">
            <div class="metric-icon data-tables">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                    <path d="M2 17l10 5 10-5"></path>
                    <path d="M2 12l10 5 10-5"></path>
                </svg>
            </div>
            <div class="metric-content">
                <div class="metric-title">데이터 테이블</div>
                <div class="metric-value">156</div>
                <div class="metric-change positive">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="18 15 12 9 6 15"></polyline>
                    </svg>
                    <span>+12%</span>
                </div>
            </div>
        </div>
        
        <div class="metric-card">
            <div class="metric-icon insights">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"></path>
                    <circle cx="12" cy="12" r="3"></circle>
                </svg>
            </div>
            <div class="metric-content">
                <div class="metric-title">생성된 인사이트</div>
                <div class="metric-value">827</div>
                <div class="metric-change positive">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="18 15 12 9 6 15"></polyline>
                    </svg>
                    <span>+23%</span>
                </div>
            </div>
        </div>
        
        <div class="metric-card">
            <div class="metric-icon reports">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polygon points="14 2 18 6 7 17 3 17 3 13 14 2"></polygon>
                    <line x1="3" y1="22" x2="21" y2="22"></line>
                </svg>
            </div>
            <div class="metric-content">
                <div class="metric-title">리포트 생성</div>
                <div class="metric-value">63</div>
                <div class="metric-change negative">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="6 9 12 15 18 9"></polyline>
                    </svg>
                    <span>-5%</span>
                </div>
            </div>
        </div>
    </div>
    
    <div class="dashboard-grid">
        <div class="dashboard-card large">
            <div class="card-header">
                <h3 class="card-title">데이터 소스 활용 현황</h3>
                <div class="card-actions">
                    <button class="card-action-button">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="19" cy="12" r="1"></circle>
                            <circle cx="5" cy="12" r="1"></circle>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="card-content">
                <div class="chart-container">
                    <div class="chart-legend">
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: var(--primary-color);"></div>
                            <div class="legend-label">생산 데이터</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #FF5E94;"></div>
                            <div class="legend-label">품질 데이터</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #FFB86C;"></div>
                            <div class="legend-label">설비 상태</div>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color" style="background-color: #64D2FF;"></div>
                            <div class="legend-label">공정 분석</div>
                        </div>
                    </div>
                    <div class="data-source-chart">
                        <div class="chart-animation">
                            <div class="chart-line"></div>
                            <div class="chart-line"></div>
                            <div class="chart-line"></div>
                            <div class="chart-line"></div>
                        </div>
                        <div class="chart-x-axis">
                            <div class="axis-label">1월</div>
                            <div class="axis-label">2월</div>
                            <div class="axis-label">3월</div>
                            <div class="axis-label">4월</div>
                            <div class="axis-label">5월</div>
                            <div class="axis-label">현재</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="dashboard-card">
            <div class="card-header">
                <h3 class="card-title">데이터 관계 분석</h3>
                <div class="card-actions">
                    <button class="card-action-button">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="19" cy="12" r="1"></circle>
                            <circle cx="5" cy="12" r="1"></circle>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="card-content">
                <div class="relationship-diagram">
                    <div class="relationship-node central">
                        <div class="node-content">
                            <div class="node-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                                    <polyline points="3.29 7 12 12 20.71 7"></polyline>
                                    <line x1="12" y1="22" x2="12" y2="12"></line>
                                </svg>
                            </div>
                            <div class="node-label">IMPtology</div>
                        </div>
                        <div class="node-connections">
                            <div class="connection-line" id="line1"></div>
                            <div class="connection-line" id="line2"></div>
                            <div class="connection-line" id="line3"></div>
                            <div class="connection-line" id="line4"></div>
                        </div>
                    </div>
                    <div class="relationship-node production">
                        <div class="node-content">
                            <div class="node-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M21 8v8a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                                    <path d="M10 2v4"></path>
                                    <path d="M14 2v4"></path>
                                    <path d="M10 18v4"></path>
                                    <path d="M14 18v4"></path>
                                </svg>
                            </div>
                            <div class="node-label">생산 데이터</div>
                        </div>
                    </div>
                    <div class="relationship-node quality">
                        <div class="node-content">
                            <div class="node-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M12 2L2 7l10 5 10-5-10-5z"></path>
                                    <path d="M2 17l10 5 10-5"></path>
                                    <path d="M2 12l10 5 10-5"></path>
                                </svg>
                            </div>
                            <div class="node-label">품질 데이터</div>
                        </div>
                    </div>
                    <div class="relationship-node equipment">
                        <div class="node-content">
                            <div class="node-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <circle cx="12" cy="12" r="10"></circle>
                                    <line x1="12" y1="16" x2="12" y2="12"></line>
                                    <line x1="12" y1="8" x2="12.01" y2="8"></line>
                                </svg>
                            </div>
                            <div class="node-label">설비 상태</div>
                        </div>
                    </div>
                    <div class="relationship-node process">
                        <div class="node-content">
                            <div class="node-icon">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <polyline points="22 12 18 12 15 21 9 3 6 12 2 12"></polyline>
                                </svg>
                            </div>
                            <div class="node-label">공정 분석</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="dashboard-card">
            <div class="card-header">
                <h3 class="card-title">주요 인사이트</h3>
                <div class="card-actions">
                    <button class="card-action-button">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="19" cy="12" r="1"></circle>
                            <circle cx="5" cy="12" r="1"></circle>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="card-content">
                <div class="insights-list">
                    <div class="insight-item">
                        <div class="insight-icon critical">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path>
                                <line x1="12" y1="9" x2="12" y2="13"></line>
                                <line x1="12" y1="17" x2="12.01" y2="17"></line>
                            </svg>
                        </div>
                        <div class="insight-content">
                            <div class="insight-title">A21 라인 생산성 저하 감지</div>
                            <div class="insight-description">지난 2시간 동안 A21 라인의 생산성이 23% 저하되었습니다. 설비 상태 점검이 필요합니다.</div>
                            <div class="insight-meta">
                                <span class="insight-time">2시간 전</span>
                                <button class="insight-action">조치하기</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon warning">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <circle cx="12" cy="12" r="10"></circle>
                                <line x1="12" y1="8" x2="12" y2="12"></line>
                                <line x1="12" y1="16" x2="12.01" y2="16"></line>
                            </svg>
                        </div>
                        <div class="insight-content">
                            <div class="insight-title">품질 불량률 증가 추세</div>
                            <div class="insight-description">B12 품목의 불량률이 지난 주 대비 8% 증가했습니다. 생산 공정 파라미터 조정이 필요합니다.</div>
                            <div class="insight-meta">
                                <span class="insight-time">1일 전</span>
                                <button class="insight-action">분석하기</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="insight-item">
                        <div class="insight-icon positive">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                                <polyline points="22 4 12 14.01 9 11.01"></polyline>
                            </svg>
                        </div>
                        <div class="insight-content">
                            <div class="insight-title">C9 공정 최적화 성공</div>
                            <div class="insight-description">C9 공정 최적화 조치 후 생산 효율이 17% 향상되었습니다. 이번 달 목표치를 초과 달성했습니다.</div>
                            <div class="insight-meta">
                                <span class="insight-time">3일 전</span>
                                <button class="insight-action">보고서 보기</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="dashboard-card large">
            <div class="card-header">
                <h3 class="card-title">데이터 테이블 활용 상위 10개</h3>
                <div class="card-actions">
                    <button class="card-action-button">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <circle cx="12" cy="12" r="1"></circle>
                            <circle cx="19" cy="12" r="1"></circle>
                            <circle cx="5" cy="12" r="1"></circle>
                        </svg>
                    </button>
                </div>
            </div>
            <div class="card-content">
                <div class="data-table-container">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>테이블 이름</th>
                                <th>소스</th>
                                <th>레코드 수</th>
                                <th>마지막 업데이트</th>
                                <th>쿼리 횟수</th>
                                <th>연관 데이터</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>production_line_a</td>
                                <td>생산관리시스템</td>
                                <td>1,245,673</td>
                                <td>5분 전</td>
                                <td>2,387</td>
                                <td>
                                    <div class="related-tags">
                                        <span class="tag">설비</span>
                                        <span class="tag">생산량</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>quality_inspection</td>
                                <td>품질관리시스템</td>
                                <td>857,432</td>
                                <td>10분 전</td>
                                <td>1,896</td>
                                <td>
                                    <div class="related-tags">
                                        <span class="tag">불량률</span>
                                        <span class="tag">검사</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>equipment_status</td>
                                <td>설비관리시스템</td>
                                <td>568,321</td>
                                <td>2분 전</td>
                                <td>1,723</td>
                                <td>
                                    <div class="related-tags">
                                        <span class="tag">가동률</span>
                                        <span class="tag">유지보수</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>process_parameters</td>
                                <td>공정관리시스템</td>
                                <td>982,145</td>
                                <td>3분 전</td>
                                <td>1,645</td>
                                <td>
                                    <div class="related-tags">
                                        <span class="tag">온도</span>
                                        <span class="tag">압력</span>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td>material_inventory</td>
                                <td>자재관리시스템</td>
                                <td>456,789</td>
                                <td>15분 전</td>
                                <td>1,432</td>
                                <td>
                                    <div class="related-tags">
                                        <span class="tag">재고</span>
                                        <span class="tag">발주</span>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script src="{{ url_for('static', path='js/dashboard.js') }}"></script>
{% endblock %}
